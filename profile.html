<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MemesHub</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>

       body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #f2f2f2;
      /* color: #333; */
    }

    header {
      background: #1f4037;
      color: white;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logout-btn {
            background-color: transparent;
            background-color: #37d88d;
            border: none;
            color: black;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 16px;
            border-radius: 6px;
        }

        .logout-btn:hover {
            transform: scale(1.05);
            text-decoration: underline;
            background-color: rgba(23, 65, 15, 0.05);
            /* subtle background on hover */
            color: white;
        }
    .container {
      max-width: 800px;
      margin: 40px auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      text-align: center;
    }

    h1 {
      color: #333;
    }

    .email-info {
      font-size: 18px;
      margin-bottom: 20px;
    }

    .navbar {
      /* background: linear-gradient(90deg, #1f4037, #99f2c8); */
      background: linear-gradient(90deg, #b9ebdd, #37d88d);;
      display: flex;
      justify-content: center;
      gap: 30px;
      padding: 15px;
      /* margin-top: 20px; */
      border-radius: 10px;
    }

    .navbar a {
        color: #1f4037;
      text-decoration: none;
      font-weight: bold;
      padding: 8px 12px;
      border-radius: 5px;
      transition: background 0.3s ease;
    }

    .navbar a:hover {
      background-color: rgba(255, 255, 255, 0.2);
    }


        .btn {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-weight: 600;
            font-size: 1.5rem;
            color: #6b7280;
            /* gray-500 */
            transition: color 0.2s;
            user-select: none;
            border: none;
            background: transparent;
            padding: 0;
        }

        .btn.liked {
            color: #f30808;
        }

        .btn.upvoted {
            color: #10b981;
            /* green-500 */
        }

        .btn.downvoted {
            color: #ef4444;
            /* red-500 */
        }

        .btn svg {
            width: 28px;
            height: 28px;
            fill: currentColor;
        }

        .comment-section {
            margin-top: 8px;
            border-top: 1px solid #e5e7eb;
            /* gray-200 */
            padding-top: 8px;
        }

        .comment-input {
            width: 100%;
            border: 1px solid #d1d5db;
            /* gray-300 */
            border-radius: 0.375rem;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .comment-list {
            max-height: 150px;
            overflow-y: auto;
        }

        .comment-item {
            background: #f3f4f6;
            /* gray-100 */
            padding: 0.5rem;
            margin-bottom: 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
        }

        .comment-item {
            background: #f3f4f6;
            padding: 0.5rem;
            margin-bottom: 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #0d0d0d;
            color: #fff;
            transition: background-color 0.3s, color 0.3s;
        } */

        /* Light mode styles */
        body.light {
            background: #f5f5f5;
            color: #111;
        }

        /* .navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background-color: #0d0d0d;
            border-bottom: 1px solid #222;
            transition: background-color 0.3s;
        } */

        /* body.light .navbar {
            background-color: #fff;
            border-bottom: 1px solid #ddd;
        } */

        /* .logo {
            display: flex;
            align-items: center;
            font-size: 22px;
            font-weight: bold;
            color: #fff;
            transition: color 0.3s;
        } */

        body.light .logo {
            color: #111;
        }

        .logo div {
            width: 32px;
            height: 32px;
            margin-right: 8px;
            border-radius: 50%;
            background: #fff;
            color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 20px;
        }

        .search-bar {
            flex: 1;
            max-width: 300px;
            margin: 0 10px;
        }

        .search-bar input {
            width: 100%;
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #444;
            background-color: #121212;
            color: #fff;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }

        body.light .search-bar input {
            background-color: #fff;
            color: #111;
            border-color: #ccc;
        }

        /* .nav-links {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .nav-links a {
            text-decoration: none;
            color: #ccc;
            font-weight: 500;
            transition: color 0.3s;
        } */

        /* .nav-links a.active {
            color: #fff;
            font-weight: bold;
        }

        body.light .nav-links a {
            color: #555;
        }

        body.light .nav-links a.active {
            color: #111;
        } */

        /* .create-btn {
            background: #fff;
            color: #000;
            padding: 6px 14px;
            border-radius: 8px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
        } */

        body.light .create-btn {
            background: #000;
            color: #fff;
        }

        /* .toggle-dark {
            margin-left: 16px;
            font-size: 18px;
            background: none;
            border: none;
            color: #fff;
            cursor: pointer;
            transition: color 0.3s;
        } */

        body.light .toggle-dark {
            color: #111;
        }

        /* .login-btn {
            margin-left: 12px;
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid #fff;
            background: transparent;
            color: #fff;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: border-color 0.3s, color 0.3s;
        } */

        body.light .login-btn {
            border-color: #111;
            color: #111;
        }

        .container {
            max-width: 900px;
            margin: auto;
            padding: 20px;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            background-color: #ffffff;
            /* color: #ffffff; */
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
        }

        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
        }

        .user-details {
            flex: 1;
        }

        .stats {
            margin-top: 10px;
        }

        .stats span {
            margin-right: 15px;
            font-size: 14px;
        }

        #followBtn {
            padding: 6px 16px;
            background-color: #008CBA;
            color: white;
            border: none;
            border-radius: 8px;
            margin-top: 10px;
            cursor: pointer;
        }

        #followBtn.following {
            background-color: #ccc;
            color: #333;
        }

        .upload-form {
            background-color: #ffffff;
            /* color: #ffffff; */
            padding: 20px;
            margin-top: 30px;
            border-radius: 12px;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
        }

        .upload-form button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
        }

        .meme-gallery {
            margin-top: 30px;
        }

        footer {
            text-align: center;
    padding: 20px 10px;
    background: #1f4037;
    color: black;
    font-size: 0.9rem;
    margin-top: 80px;
    border-top: 1px solid #222;
}

body.light footer {
    background-color: #fff;
    color: #777;
    border-top: 1px solid #ddd;
}

footer a {
    color: #666;
    text-decoration: none;
    margin: 0 6px;
    font-weight: 600;
}

body.light footer a {
    color: #999;
}

footer a:hover {
    text-decoration: underline;
}

/* Responsive */
@media (max-width: 850px) {

    .features,
    .steps {
        flex-direction: column;
        align-items: center;
    }
}


    </style>

</head>

<body class="bg-gray-50 text-gray-900">
    <!-- <div id="userWelcome">Welcome!   Home</div> -->
    
    <header>
        <div id="userWelcome">Welcome!   Home</div>
        
        <nav class="navbar">
        <a href="dashboard.html">🏠 Home</a>
        <a href="explore.html">🔍 Explore</a>
        <a href="meme-creation.html">🎨 Create Meme</a>
        <a href="gallery.html">🖼️ My Memes</a>
        <a href="profile.html">👤 Profile</a>
      
      </nav>
        <button class="logout-btn" id="logoutBtn">Logout</button>
      </header>
    <!-- <button class="logout-btn" id="logoutBtn">Logout</button> -->
  

    <div class="container">
        <!-- Profile Header -->
        <div class="profile-header">
            <img src="https://i.pravatar.cc/100?img=5" alt="User" class="avatar" />
            <div class="user-details">
                <h2 id="usernameDisplay">@meme_master</h2>
                <p>😂 Meme Creator | 🎨 Creative Mind</p>
                <div class="stats">
                    <span><strong id="memeCount">0</strong> Memes</span>
                    <span><strong id="likeCount">0</strong> Likes</span>
                    <span><strong id="followerCount">100</strong> Followers</span>
                </div>
                <button id="followBtn">Follow</button>
            </div>
        </div>

        <!-- Upload Meme Form -->
        <div class="upload-form">
            <h3>Upload New Meme</h3>
            <a href="meme-creation.html"><button>Post Meme</button></a>
        </div>
    </div>
    <div class="container mx-auto px-4 py-12">
        <!-- <h1 class="text-4xl font-bold mb-8 text-center">Explore</h1> -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="memeContainer"></div>
    </div>
     <footer>
        <p>&copy; 2025 MemeHub. All rights reserved.</p>
        <p>
            <a href="#">About</a> |
            <a href="#">Terms</a> |
            <a href="#">Privacy</a> |
            <a href="#">Contact</a>
        </p>
    </footer>


    <script type="module">
        const followBtn = document.getElementById('followBtn');
        const memeCount = document.getElementById('memeCount')
        const likeCountDisplay = document.getElementById('likeCount');
        function toggleDarkMode() {
            document.body.classList.toggle("light");
            const btn = document.querySelector(".toggle-dark");
            btn.textContent = document.body.classList.contains("light") ? "🌞" : "🌙";
        }
        let memes = [];

        function getInteractions() {
            return JSON.parse(localStorage.getItem('memeInteractions') || '{}');
        }

        function saveInteractions(interactions) {
            localStorage.setItem('memeInteractions', JSON.stringify(interactions));
        }

        async function fetchMemes() {
            try {
                const response = await axios.get('https://www.reddit.com/r/memes/top.json?t=week&limit=5');
                memes = response.data.data.children.map(c => c.data);
                displayMemes();
                memeCount.textContent = memes.length;
            } catch (error) {
                console.error('Error fetching memes:', error);
            }
        }

        function displayMemes() {
            const container = document.getElementById('memeContainer');
            container.innerHTML = '';
            const interactions = getInteractions();
            let totalLikes = 0;

            

            memes.forEach(meme => {
                const memeId = meme.id;
                const interaction = interactions[memeId] || {
                    liked: false,
                    upvoted: false,
                    downvoted: false,
                    comments: []
                };

                // Use ups from Reddit + local like count (1 max)
                const likeCount = (interaction.liked ? 1 : 0) + meme.ups;
                totalLikes += likeCount;
                likeCountDisplay.textContent = totalLikes;
                const upvoteCount = (interaction.upvoted ? 1 : 0);
                const downvoteCount = (interaction.downvoted ? 1 : 0);
                const comments = interaction.comments || [];

                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow overflow-hidden flex flex-col';

                card.innerHTML = `
          <div class="w-full h-64 bg-gray-100 flex items-center justify-center overflow-hidden">
            <img src="${meme.url}" alt="${meme.title}" class="max-h-full max-w-full object-contain" />
          </div>
          <div class="p-4 flex flex-col flex-grow">
            <h3 class="text-xl font-semibold mb-2">${meme.title}</h3>
            <p class="text-sm text-gray-500 mb-2">by ${meme.author} in r/${meme.subreddit}</p>

            <div class="flex gap-6 mb-4 items-center">
              <button class="btn like-btn ${interaction.liked ? 'liked' : ''}" aria-label="Like meme">
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="m480-120-58-52q-101-91-167-157T150-447.5Q111-500 95.5-544T80-634q0-94 63-157t157-63q52 0 99 22t81 62q34-40 81-62t99-22q94 0 157 63t63 157q0 46-15.5 90T810-447.5Q771-395 705-329T538-172l-58 52Z"/></svg>
                <span class="likes-count">${likeCount}</span>
              </button>

              <button class="btn upvote-btn ${interaction.upvoted ? 'upvoted' : ''}" aria-label="Upvote meme">
                <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="#e3e3e3"><path d="M444-96v-630L267-549l-51-51 264-264 264 264-51 51-177-177v630h-72Z"/></svg>
                <span class="upvotes-count">${upvoteCount}</span>
              </button>

              <button class="btn downvote-btn ${interaction.downvoted ? 'downvoted' : ''}" aria-label="Downvote meme">
                <svg xmlns="http://www.w3.org/2000/svg" height="10px" viewBox="0 -960 960 960" width="20px" fill="#e3e3e3"><path d="M480-96 216-360l51-51 177 177v-630h72v630l177-177 51 51L480-96Z"/></svg>
                <span class="downvotes-count">${downvoteCount}</span>
              </button>

              <button class="btn comment-toggle-btn" aria-label="Toggle comments">
                <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="#e3e3e3"><path d="M864-96 720-240H168q-29.7 0-50.85-21.15Q96-282.3 96-312v-480q0-29.7 21.15-50.85Q138.3-864 168-864h624q29.7 0 50.85 21.15Q864-821.7 864-792v696ZM168-312h582l42 42v-522H168v480Zm0 0v-480 480Z"/></svg> (${comments.length})
              </button>
            </div>

            <div class="comment-section hidden">
              <textarea class="comment-input" placeholder="Write a comment..."></textarea>
              <button class="btn add-comment-btn bg-blue-500 text-white rounded px-3 py-1">Add Comment</button>
              <div class="comment-list mt-2"></div>
            </div>
          </div>
        `;

                // Like button toggle
                card.querySelector('.like-btn').addEventListener('click', () => {
                    const interactions = getInteractions();

                    if (interactions[memeId]?.liked) {
                        interactions[memeId].liked = false;
                    } else {
                        interactions[memeId] = interactions[memeId] || {};
                        interactions[memeId].liked = true;
                        interactions[memeId].upvoted = false;
                        interactions[memeId].downvoted = false;
                    }
                    saveInteractions(interactions);
                    displayMemes();
                });

                // Upvote button toggle
                card.querySelector('.upvote-btn').addEventListener('click', () => {
                    const interactions = getInteractions();

                    if (interactions[memeId]?.upvoted) {
                        interactions[memeId].upvoted = false;
                    } else {
                        interactions[memeId] = interactions[memeId] || {};
                        interactions[memeId].upvoted = true;
                        interactions[memeId].downvoted = false;
                        interactions[memeId].liked = false;
                    }
                    saveInteractions(interactions);
                    displayMemes();
                });

                // Downvote button toggle
                card.querySelector('.downvote-btn').addEventListener('click', () => {
                    const interactions = getInteractions();

                    if (interactions[memeId]?.downvoted) {
                        interactions[memeId].downvoted = false;
                    } else {
                        interactions[memeId] = interactions[memeId] || {};
                        interactions[memeId].downvoted = true;
                        interactions[memeId].upvoted = false;
                        interactions[memeId].liked = false;
                    }
                    saveInteractions(interactions);
                    displayMemes();
                });

                // Comment toggle
                const commentToggleBtn = card.querySelector('.comment-toggle-btn');
                const commentSection = card.querySelector('.comment-section');
                commentToggleBtn.addEventListener('click', () => {
                    commentSection.classList.toggle('hidden');
                });

                // Render existing comments

                const commentList = card.querySelector('.comment-list');
                commentList.innerHTML = '';
                comments.forEach((commentText, index) => {
                    const commentDiv = document.createElement('div');
                    commentDiv.className = 'comment-item flex justify-between items-center';

                    const textSpan = document.createElement('span');
                    textSpan.textContent = commentText;

                    const deleteBtn = document.createElement('button');
                    deleteBtn.textContent = '❌';
                    deleteBtn.className = 'text-red-500 ml-2 text-sm hover:text-red-700';
                    deleteBtn.title = 'Delete comment';

                    deleteBtn.addEventListener('click', () => {
                        const interactions = getInteractions();
                        interactions[memeId].comments.splice(index, 1);
                        saveInteractions(interactions);
                        displayMemes();
                    });

                    commentDiv.appendChild(textSpan);
                    commentDiv.appendChild(deleteBtn);
                    commentList.appendChild(commentDiv);
                });


                // Add comment
                const addCommentBtn = card.querySelector('.add-comment-btn');
                const commentInput = card.querySelector('.comment-input');
                addCommentBtn.addEventListener('click', () => {
                    const commentText = commentInput.value.trim();
                    if (!commentText) return alert('Comment cannot be empty!');

                    const interactions = getInteractions();
                    interactions[memeId] = interactions[memeId] || { comments: [] };
                    if (!interactions[memeId].comments) {
                        interactions[memeId].comments = [];
                    }
                    interactions[memeId].comments.push(commentText);
                    saveInteractions(interactions);

                    commentInput.value = '';
                    displayMemes();
                });

                container.appendChild(card);
            });
        }

        const followerCountSpan = document.getElementById('followerCount');
        let isFollowing = false;
        let followerCount = 100;
        followBtn.addEventListener('click', () => {
            isFollowing = !isFollowing;
            followerCount += isFollowing ? 1 : -1;
            followBtn.textContent = isFollowing ? 'Unfollow' : 'Follow';
            followBtn.classList.toggle('following', isFollowing);
            followerCountSpan.textContent = `${followerCount} `;
        });
        fetchMemes();
       

        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBv1mD2brzhfDxgZyjUis6j0XmhsQcPwMI",
      authDomain: "hackathons-project-83560.firebaseapp.com",
      databaseURL: "https://hackathons-project-83560-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "hackathons-project-83560",
      storageBucket: "hackathons-project-83560.appspot.com",
      messagingSenderId: "693799285364",
      appId: "1:693799285364:web:3c5b3ea19bf53bd4ce9721"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const emailInfo = document.getElementById('emailInfo');
    const userWelcome = document.getElementById('userWelcome');
    const logoutBtn = document.getElementById('logoutBtn');

    onAuthStateChanged(auth, (user) => {
      if (user) {
        emailInfo.textContent = `📧 Logged in as: ${user.email}`;
        userWelcome.textContent = `👋 Welcome, ${user.email}`;
      } else {
        // Redirect to login if not authenticated
        window.location.href = 'index.html';
      }
    });

    logoutBtn.addEventListener('click', () => {
      signOut(auth).then(() => {
        window.location.href = 'index.html';
      }).catch((error) => {
        alert('Logout failed: ' + error.message);
      });
    });
    </script>
</body>

</html>